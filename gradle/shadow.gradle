jar {
    manifest {
        attributes(
                "Implementation-Title": applicationName,
                "Implementation-Version": version,
                "Main-Class": mainClass
        )
    }
}

shadowJar {
    baseName appBaseName
    archiveName "${appBaseName}.jar"
    destinationDir buildDir

    mergeServiceFiles()
    exclude 'META-INF/*.SF'
    exclude 'META-INF/*.DSA'
    exclude 'META-INF/*.RSA'
}

task shadowRun (dependsOn: 'shadowJar') << {
    javaexec {
        main = "-jar"
        args = ["${buildDir}/${appBaseName}.jar", 'server', config ]
    }
}

publishing {
    publications {
        shadow(MavenPublication) {
            from components.shadow
            artifactId = appBaseName
        }
    }
}

